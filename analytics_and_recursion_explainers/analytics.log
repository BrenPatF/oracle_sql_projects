
Database             Time                 Version
-------------------- -------------------- ------------------------------
Start: ORCL          12-FEB-2020 06:22:51 Version 19.3.0.0.0

Average by Grouping

DEPARTMENT_ID AVG_SALARY
------------- ----------
           10       4400
           20       9500
           30       4150
           40       6500
           50 3475.55556
           60       5760
           70      10000
           80 8955.88235
           90 19333.3333
          100 8601.33333
          110      10154
                    7000

12 rows selected.

  1  SELECT department_id, AVG(salary) avg_salary
  2    FROM employees
  3   GROUP BY department_id
  4*  ORDER BY department_id

Analytic Averages: Overall, running and 3-point moving

DEPARTMENT_ID EMPLOYEE_ID     SALARY AVG_SALARY RUN_AVG_SALARY MOVING_AVG_SALARY_3
------------- ----------- ---------- ---------- -------------- -------------------
           10         200       4400       4400           4400                4400
           20         201      13000       9500          13000               13000
                      202       6000       9500           9500                9500
           30         114      11000       4150          11000               11000
                      115       3100       4150           7050                7050
                      116       2900       4150     5666.66667          5666.66667
                      117       2800       4150           4950          2933.33333
                      118       2600       4150           4480          2766.66667
                      119       2500       4150           4150          2633.33333
           40         203       6500       6500           6500                6500
           50         120       8000 3475.55556           8000                8000
                      121       8200 3475.55556           8100                8100
                      122       7900 3475.55556     8033.33333          8033.33333
                      123       6500 3475.55556           7650          7533.33333
                      124       5800 3475.55556           7280          6733.33333
                      125       3200 3475.55556           6600          5166.66667
                      126       2700 3475.55556     6042.85714                3900
                      127       2400 3475.55556         5587.5          2766.66667
                      128       2200 3475.55556     5211.11111          2433.33333
                      129       3300 3475.55556           5020          2633.33333
                      130       2800 3475.55556     4818.18182          2766.66667
                      131       2500 3475.55556           4625          2866.66667
                      132       2100 3475.55556     4430.76923          2466.66667
                      133       3300 3475.55556           4350          2633.33333
                      134       2900 3475.55556     4253.33333          2766.66667
                      135       2400 3475.55556         4137.5          2866.66667
                      136       2200 3475.55556     4023.52941                2500
                      137       3600 3475.55556           4000          2733.33333
                      138       3200 3475.55556     3957.89474                3000
                      139       2700 3475.55556           3895          3166.66667
                      140       2500 3475.55556     3828.57143                2800
                      141       3500 3475.55556     3813.63636                2900
                      142       3100 3475.55556      3782.6087          3033.33333
                      143       2600 3475.55556     3733.33333          3066.66667
                      144       2500 3475.55556           3684          2733.33333
                      180       3200 3475.55556     3665.38462          2766.66667
                      181       3100 3475.55556     3644.44444          2933.33333
                      182       2500 3475.55556     3603.57143          2933.33333
                      183       2800 3475.55556     3575.86207                2800
                      184       4200 3475.55556     3596.66667          3166.66667
                      185       4100 3475.55556     3612.90323                3700
                      186       3400 3475.55556        3606.25                3900
                      187       3000 3475.55556     3587.87879                3500
                      188       3800 3475.55556     3594.11765                3400
                      189       3600 3475.55556     3594.28571          3466.66667
                      190       2900 3475.55556           3575          3433.33333
                      191       2500 3475.55556     3545.94595                3000
                      192       4000 3475.55556     3557.89474          3133.33333
                      193       3900 3475.55556     3566.66667          3466.66667
                      194       3200 3475.55556         3557.5                3700
                      195       2800 3475.55556     3539.02439                3300
                      196       3100 3475.55556     3528.57143          3033.33333
                      197       3000 3475.55556     3516.27907          2966.66667
                      198       2600 3475.55556     3495.45455                2900
                      199       2600 3475.55556     3475.55556          2733.33333
           60         103       9000       5760           9000                9000
                      104       6000       5760           7500                7500
                      105       4800       5760           6600                6600
                      106       4800       5760           6150                5200
                      107       4200       5760           5760                4600
           70         204      10000      10000          10000               10000
           80         145      14000 8955.88235          14000               14000
                      146      13500 8955.88235          13750               13750
                      147      12000 8955.88235     13166.6667          13166.6667
                      148      11000 8955.88235          12625          12166.6667
                      149      10500 8955.88235          12200          11166.6667
                      150      10000 8955.88235     11833.3333               10500
                      151       9500 8955.88235          11500               10000
                      152       9000 8955.88235        11187.5                9500
                      153       8000 8955.88235     10833.3333          8833.33333
                      154       7500 8955.88235          10500          8166.66667
                      155       7000 8955.88235     10181.8182                7500
                      156      10000 8955.88235     10166.6667          8166.66667
                      157       9500 8955.88235     10115.3846          8833.33333
                      158       9000 8955.88235     10035.7143                9500
                      159       8000 8955.88235           9900          8833.33333
                      160       7500 8955.88235           9750          8166.66667
                      161       7000 8955.88235     9588.23529                7500
                      162      10500 8955.88235     9638.88889          8333.33333
                      163       9500 8955.88235     9631.57895                9000
                      164       7200 8955.88235           9510          9066.66667
                      165       6800 8955.88235     9380.95238          7833.33333
                      166       6400 8955.88235     9245.45455                6800
                      167       6200 8955.88235     9113.04348          6466.66667
                      168      11500 8955.88235         9212.5          8033.33333
                      169      10000 8955.88235           9244          9233.33333
                      170       9600 8955.88235     9257.69231          10366.6667
                      171       7400 8955.88235     9188.88889                9000
                      172       7300 8955.88235     9121.42857                8100
                      173       6100 8955.88235     9017.24138          6933.33333
                      174      11000 8955.88235     9083.33333          8133.33333
                      175       8800 8955.88235     9074.19355          8633.33333
                      176       8600 8955.88235       9059.375          9466.66667
                      177       8400 8955.88235     9039.39394                8600
                      179       6200 8955.88235     8955.88235          7733.33333
           90         100      24000 19333.3333          24000               24000
                      101      17000 19333.3333          20500               20500
                      102      17000 19333.3333     19333.3333          19333.3333
          100         108      12008 8601.33333          12008               12008
                      109       9000 8601.33333          10504               10504
                      110       8200 8601.33333           9736                9736
                      111       7700 8601.33333           9227                8300
                      112       7800 8601.33333         8941.6                7900
                      113       6900 8601.33333     8601.33333          7466.66667
          110         205      12008      10154          12008               12008
                      206       8300      10154          10154               10154
                      178       7000       7000           7000                7000

107 rows selected.

  1  SELECT department_id, employee_id, salary,
  2         AVG(salary) OVER (PARTITION BY department_id) avg_salary,
  3         AVG(salary) OVER (PARTITION BY department_id ORDER BY employee_id) run_avg_salary,
  4         AVG(salary) OVER (PARTITION BY department_id ORDER BY employee_id
  5         		ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) moving_avg_salary_3
  6    FROM employees
  7*  ORDER BY department_id, employee_id

Analytics on Grouping: Running sum of the department average salaries

DEPARTMENT_ID AVG_SALARY RUN_SUM_AVG_SALARY
------------- ---------- ------------------
           10       4400               4400
           20       9500              13900
           30       4150              18050
           40       6500              24550
           50 3475.55556         28025.5556
           60       5760         33785.5556
           70      10000         43785.5556
           80 8955.88235         52741.4379
           90 19333.3333         72074.7712
          100 8601.33333         80676.1046
          110      10154         90830.1046
                    7000         97830.1046

12 rows selected.

  1  SELECT department_id, AVG(salary) avg_salary,
  2         SUM(AVG(salary)) OVER (ORDER BY department_id) run_sum_avg_salary
  3    FROM employees
  4   GROUP BY department_id
  5*  ORDER BY department_id

'END:'||TO_CHAR(SYSDATE,'DD-MON-YY
----------------------------------
End: 12-FEB-2020 06:22:52

